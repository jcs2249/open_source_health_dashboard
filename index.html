<!DOCTYPE html>
<html>
<head>
  <title>Open Source Health Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    .pass { color: green; font-weight: bold; }
    .fail { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Open Source Health Dashboard</h1>
  <input type="text" id="repoInput" placeholder="Enter GitHub repo (e.g. facebook/react)" />
  <button onclick="checkRepo()">Check</button>

  <table id="results" style="display:none;">
    <tr><th>Check</th><th>Status</th></tr>
    <tr><td>LICENSE</td><td id="license"></td></tr>
    <tr><td>README.md</td><td id="readme"></td></tr>
    <tr><td>.gitignore</td><td id="gitignore"></td></tr>
    <tr><td>Recent Commit (6mo)</td><td id="commit"></td></tr>
    <tr><td>GitHub Actions</td><td id="actions"></td></tr>
  </table>

  <script>
    async function checkRepo() {
      const repo = document.getElementById("repoInput").value.trim();
      if (!repo) return alert("Please enter owner/repo (e.g. facebook/react)");

      document.getElementById("results").style.display = "table";

      const base = `https://api.github.com/repos/${repo}`;
      
      // Helper for marking checks
      function mark(id, ok) {
        document.getElementById(id).innerHTML = ok ? '<span class="pass">GOOD</span>' : '<span class="fail">BAD</span>';
      }

      try {
        // LICENSE
        const license = await fetch(`${base}/license`);
        mark("license", license.ok);

        // README
        const readme = await fetch(`${base}/readme`);
        mark("readme", readme.ok);

        // .gitignore
        const gitignore = await fetch(`${base}/contents/.gitignore`);
        mark("gitignore", gitignore.ok);

        // Commit activity
        const commits = await fetch(`${base}/commits?per_page=1`);
        if (commits.ok) {
          const data = await commits.json();
          const lastCommit = new Date(data[0].commit.author.date);
          const sixMonthsAgo = new Date();
          sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);
          mark("commit", lastCommit > sixMonthsAgo);
        } else {
          mark("commit", false);
        }

        // GitHub Actions
        const actions = await fetch(`${base}/contents/.github/workflows`);
        mark("actions", actions.ok);
      } catch (err) {
        alert("Error fetching repo: " + err);
      }
    }
  </script>
</body>
</html>
